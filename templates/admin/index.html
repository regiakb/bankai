{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/admin_custom.css' %}">
<style>
.dashboard {
    padding: 20px;
    background: #1a1a1a;
}
</style>
{% endblock %}

{% block coltype %}colMS{% endblock %}

{% block bodyclass %}{{ block.super }} dashboard{% endblock %}

{% block breadcrumbs %}{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
        {% for app in app_list %}
        <div class="card" style="background: #252525; border: 1px solid #404040; border-radius: 4px; padding: 20px;">
            <h3 style="color: #e0e0e0; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #404040; font-size: 18px;">
                <a href="{{ app.app_url }}" style="color: #c41e3a; text-decoration: none; font-weight: 600;">{{ app.name }}</a>
            </h3>
            {% if app.models %}
            <table style="width: 100%; border-collapse: collapse;">
                <tbody>
                    {% for model in app.models %}
                    <tr style="border-bottom: 1px solid #404040;">
                        <td style="padding: 12px 0; color: #e0e0e0;">
                            {% if model.admin_url %}
                                <a href="{{ model.admin_url }}" style="color: #6bb6ff; text-decoration: none; font-weight: 500;">{{ model.name }}</a>
                            {% else %}
                                <span style="color: #b0b0b0;">{{ model.name }}</span>
                            {% endif %}
                        </td>
                        <td style="text-align: right; padding: 12px 0;">
                            {% if model.add_url %}
                                <a href="{{ model.add_url }}" class="btn" style="padding: 6px 12px; font-size: 12px; background: #28a745; color: white; text-decoration: none; border-radius: 4px; margin-left: 5px;">AÃ±adir</a>
                            {% endif %}
                            {% if model.admin_url %}
                                <a href="{{ model.admin_url }}" class="btn" style="padding: 6px 12px; font-size: 12px; background: #6bb6ff; color: white; text-decoration: none; border-radius: 4px;">Ver</a>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p style="color: #b0b0b0; padding: 10px;">No hay modelos disponibles.</p>
            {% endif %}
        </div>
        {% empty %}
        <div class="card">
            <p style="color: #b0b0b0; text-align: center; padding: 20px;">No hay aplicaciones disponibles.</p>
        </div>
        {% endfor %}
    </div>
    
    {% if recent_actions %}
    <div class="card" style="margin-top: 20px; background: #252525; border: 1px solid #404040; border-radius: 4px; padding: 20px;">
        <h3 style="color: #e0e0e0; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #404040; font-size: 18px;">
            Actividad Reciente
        </h3>
        <div class="table-responsive">
            <table style="width: 100%;">
                <thead>
                    <tr style="background: #2d2d2d;">
                        <th style="padding: 12px; text-align: left; color: #e0e0e0; font-weight: 600; border-bottom: 2px solid #404040;">Fecha</th>
                        <th style="padding: 12px; text-align: left; color: #e0e0e0; font-weight: 600; border-bottom: 2px solid #404040;">Tipo</th>
                        <th style="padding: 12px; text-align: left; color: #e0e0e0; font-weight: 600; border-bottom: 2px solid #404040;">Objeto</th>
                    </tr>
                </thead>
                <tbody>
                    {% for action in recent_actions %}
                    <tr style="border-bottom: 1px solid #404040;">
                        <td style="padding: 12px; color: #e0e0e0;">{{ action.action_time|date:"Y-m-d H:i" }}</td>
                        <td style="padding: 12px; color: #b0b0b0;">{{ action.content_type.name }}</td>
                        <td style="padding: 12px; color: #e0e0e0;">{{ action.object_repr }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" style="padding: 20px; text-align: center; color: #b0b0b0;">No hay actividad reciente.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
